{"version":3,"sources":["..\\..\\..\\..\\assets\\script/assets\\script\\player.js"],"names":["cc","Class","extends","Component","properties","jumpHeight","jumpDuration","maxMoveSpeed","accel","jumpAudio","default","type","AudioClip","onLoad","jumpAction","setJumpAction","node","runAction","accelLeft","accelRight","xSpeed","systemEvent","on","SystemEvent","EventType","KEY_DOWN","onKeyDown","KEY_UP","onKeyUp","onDestroy","off","start","update","dt","Math","abs","x","jumpUp","moveBy","v2","easing","easeCircleActionOut","jumpDown","easeCircleActionIn","callback","callFunc","playJumpSound","console","log","repeatForever","sequence","audioEngine","playEffect","event","keyCode","macro","KEY","a","d"],"mappings":";;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEAA,GAAGC,KAAH,CAAS;AACLC,aAASF,GAAGG,SADP;;AAGLC,gBAAY;AACR;AACAC,oBAAY,CAFJ;AAGR;AACAC,sBAAc,CAJN;AAKR;AACAC,sBAAc,CANN;AAOR;AACAC,eAAO,CARC;AASR;AACAC,mBAAU;AACNC,qBAAS,IADH;AAENC,kBAAMX,GAAGY;AAFH;;AAVF,KAHP;;AAoBL;;AAEAC,UAtBK,oBAsBK;AACN;AACA,aAAKC,UAAL,GAAkB,KAAKC,aAAL,EAAlB;AACA,aAAKC,IAAL,CAAUC,SAAV,CAAoB,KAAKH,UAAzB;AACA;AACA,aAAKI,SAAL,GAAiB,KAAjB;AACA,aAAKC,UAAL,GAAkB,KAAlB;AACA;AACA,aAAKC,MAAL,GAAc,CAAd;AACA;AACApB,WAAGqB,WAAH,CAAeC,EAAf,CAAkBtB,GAAGuB,WAAH,CAAeC,SAAf,CAAyBC,QAA3C,EAAoD,KAAKC,SAAzD,EAAmE,IAAnE;AACA1B,WAAGqB,WAAH,CAAeC,EAAf,CAAkBtB,GAAGuB,WAAH,CAAeC,SAAf,CAAyBG,MAA3C,EAAkD,KAAKC,OAAvD,EAA+D,IAA/D;AAEH,KAnCI;AAoCLC,aApCK,uBAoCM;AACP;AACA7B,WAAGqB,WAAH,CAAeS,GAAf,CAAmB9B,GAAGuB,WAAH,CAAeC,SAAf,CAAyBC,QAA5C,EAAqD,KAAKC,SAA1D,EAAoE,IAApE;AACA1B,WAAGqB,WAAH,CAAeS,GAAf,CAAmB9B,GAAGuB,WAAH,CAAeC,SAAf,CAAyBG,MAA5C,EAAmD,KAAKC,OAAxD,EAAgE,IAAhE;AACH,KAxCI;AA0CLG,SA1CK,mBA0CI,CAER,CA5CI;AA8CLC,UA9CK,kBA8CGC,EA9CH,EA8CO;AACR;AACA;AACA,YAAG,KAAKf,SAAR,EAAkB;AACd,iBAAKE,MAAL,IAAe,KAAKZ,KAAL,GAAayB,EAA5B;AACH,SAFD,MAEM,IAAG,KAAKd,UAAR,EAAmB;AACrB,iBAAKC,MAAL,IAAe,KAAKZ,KAAL,GAAayB,EAA5B;AACH;AACD;AACA;AACA,YAAGC,KAAKC,GAAL,CAAS,KAAKf,MAAd,IAAwB,KAAKb,YAAhC,EAA6C;AACzC,iBAAKa,MAAL,GAAc,KAAKb,YAAL,GAAoB,KAAKa,MAAzB,GAAgCc,KAAKC,GAAL,CAAS,KAAKf,MAAd,CAA9C;AACH;AACD;AACA,aAAKJ,IAAL,CAAUoB,CAAV,IAAe,KAAKhB,MAAL,GAAca,EAA7B;AACH,KA7DI;AA8DLlB,iBA9DK,2BA8DY;AACb;AACA,YAAIsB,SAASrC,GAAGsC,MAAH,CAAU,KAAKhC,YAAf,EAA4BN,GAAGuC,EAAH,CAAM,CAAN,EAAQ,KAAKlC,UAAb,CAA5B,EAAsDmC,MAAtD,CAA6DxC,GAAGyC,mBAAH,EAA7D,CAAb;AACA;AACA,YAAIC,WAAW1C,GAAGsC,MAAH,CAAU,KAAKhC,YAAf,EAA4BN,GAAGuC,EAAH,CAAM,CAAN,EAAQ,CAAC,KAAKlC,UAAd,CAA5B,EAAuDmC,MAAvD,CAA8DxC,GAAG2C,kBAAH,EAA9D,CAAf;AACA;AACA,YAAIC,WAAW5C,GAAG6C,QAAH,CAAY,KAAKC,aAAjB,EAA+B,IAA/B,CAAf;AACAC,gBAAQC,GAAR,CAAY,KAAKF,aAAjB;AACA;AACA,eAAO9C,GAAGiD,aAAH,CAAiBjD,GAAGkD,QAAH,CAAYb,MAAZ,EAAmBK,QAAnB,EAA4BE,QAA5B,CAAjB,CAAP;AACH,KAxEI;AAyELE,iBAzEK,2BAyEY;AACb;AACA9C,WAAGmD,WAAH,CAAeC,UAAf,CAA0B,KAAK3C,SAA/B,EAAyC,KAAzC;AACH,KA5EI;AA8ELiB,aA9EK,qBA8EM2B,KA9EN,EA8Ea;AACd,gBAAOA,MAAMC,OAAb;AACI,iBAAKtD,GAAGuD,KAAH,CAASC,GAAT,CAAaC,CAAlB;AACI,qBAAKvC,SAAL,GAAiB,IAAjB;AACA;AACJ,iBAAKlB,GAAGuD,KAAH,CAASC,GAAT,CAAaE,CAAlB;AACI,qBAAKvC,UAAL,GAAkB,IAAlB;AACA;AANR;AAQH,KAvFI;;AAwFLS,aAAS,iBAASyB,KAAT,EAAe;AACpB,gBAAOA,MAAMC,OAAb;AACI,iBAAKtD,GAAGuD,KAAH,CAASC,GAAT,CAAaC,CAAlB;AACI,qBAAKvC,SAAL,GAAiB,KAAjB;AACA;AACJ,iBAAKlB,GAAGuD,KAAH,CAASC,GAAT,CAAaE,CAAlB;AACI,qBAAKvC,UAAL,GAAiB,KAAjB;AACA;AANR;AAQH;AAjGI,CAAT","file":"player.js","sourceRoot":"..\\..\\..\\..\\assets\\script","sourcesContent":["// Learn cc.Class:\r\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/class.html\r\n//  - [English] http://docs.cocos2d-x.org/creator/manual/en/scripting/class.html\r\n// Learn Attribute:\r\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/reference/attributes.html\r\n//  - [English] http://docs.cocos2d-x.org/creator/manual/en/scripting/reference/attributes.html\r\n// Learn life-cycle callbacks:\r\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/life-cycle-callbacks.html\r\n//  - [English] https://www.cocos2d-x.org/docs/creator/manual/en/scripting/life-cycle-callbacks.html\r\n\r\ncc.Class({\r\n    extends: cc.Component,\r\n    \r\n    properties: {\r\n        // 角色跳躍高度\r\n        jumpHeight: 0,\r\n        // 角色跳躍持續時間\r\n        jumpDuration: 0,\r\n        // 最大移動速度\r\n        maxMoveSpeed: 0,\r\n        // 加速度\r\n        accel: 0,\r\n        // 跳躍音效\r\n        jumpAudio:{\r\n            default: null,\r\n            type: cc.AudioClip\r\n        },\r\n\r\n    },\r\n\r\n    // LIFE-CYCLE CALLBACKS:\r\n\r\n    onLoad () {\r\n        // 初始化跳躍動作\r\n        this.jumpAction = this.setJumpAction();\r\n        this.node.runAction(this.jumpAction);\r\n        // 左右加速度開關\r\n        this.accelLeft = false;\r\n        this.accelRight = false;\r\n        // 角色當前水平移動速度\r\n        this.xSpeed = 0;\r\n        // 初始化鍵盤監聽事件\r\n        cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN,this.onKeyDown,this);\r\n        cc.systemEvent.on(cc.SystemEvent.EventType.KEY_UP,this.onKeyUp,this);\r\n    \r\n    },\r\n    onDestroy(){\r\n        // 取消鍵盤監聽事件\r\n        cc.systemEvent.off(cc.SystemEvent.EventType.KEY_DOWN,this.onKeyDown,this);\r\n        cc.systemEvent.off(cc.SystemEvent.EventType.KEY_UP,this.onKeyUp,this);\r\n    },\r\n\r\n    start () {\r\n\r\n    },\r\n\r\n    update (dt) {\r\n        // console.log(this.accelLeft,this.accelRight);\r\n        // 依照當今加速度方向更新水平移動數值\r\n        if(this.accelLeft){\r\n            this.xSpeed -= this.accel * dt;\r\n        }else if(this.accelRight){\r\n            this.xSpeed += this.accel * dt;\r\n        }\r\n        // console.log(this.xSpeed);\r\n        // 限制水平移動最大值\r\n        if(Math.abs(this.xSpeed) > this.maxMoveSpeed){\r\n            this.xSpeed = this.maxMoveSpeed * this.xSpeed/Math.abs(this.xSpeed);\r\n        }\r\n        // 更新角色位置\r\n        this.node.x += this.xSpeed * dt;\r\n    },\r\n    setJumpAction () {\r\n        // 跳躍上升\r\n        var jumpUp = cc.moveBy(this.jumpDuration,cc.v2(0,this.jumpHeight)).easing(cc.easeCircleActionOut());\r\n        // 降落\r\n        var jumpDown = cc.moveBy(this.jumpDuration,cc.v2(0,-this.jumpHeight)).easing(cc.easeCircleActionIn());\r\n        // 增添一個回調函數，用於動作結束後使用這個方法\r\n        var callback = cc.callFunc(this.playJumpSound,this);\r\n        console.log(this.playJumpSound);\r\n        // 不斷重複\r\n        return cc.repeatForever(cc.sequence(jumpUp,jumpDown,callback));\r\n    },\r\n    playJumpSound () {\r\n        // 調用聲音引擎撥放聲音\r\n        cc.audioEngine.playEffect(this.jumpAudio,false);\r\n    },\r\n\r\n    onKeyDown (event) {\r\n        switch(event.keyCode){\r\n            case cc.macro.KEY.a:\r\n                this.accelLeft = true;\r\n                break;\r\n            case cc.macro.KEY.d:\r\n                this.accelRight = true;\r\n                break;\r\n        }\r\n    },\r\n    onKeyUp: function(event){\r\n        switch(event.keyCode){\r\n            case cc.macro.KEY.a:\r\n                this.accelLeft = false;\r\n                break;\r\n            case cc.macro.KEY.d:\r\n                this.accelRight= false;\r\n                break;\r\n        }\r\n    },\r\n});\r\n"]}